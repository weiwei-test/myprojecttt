{"remainingRequest":"C:\\Users\\Administrator\\Downloads\\myprojectt-master\\vueDataV-master\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Administrator\\Downloads\\myprojectt-master\\vueDataV-master\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\Administrator\\Downloads\\myprojectt-master\\vueDataV-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Downloads\\myprojectt-master\\vueDataV-master\\src\\views\\Dmsorder.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\Administrator\\Downloads\\myprojectt-master\\vueDataV-master\\src\\views\\Dmsorder.vue","mtime":1714314763000},{"path":"C:\\Users\\Administrator\\Downloads\\myprojectt-master\\vueDataV-master\\babel.config.js","mtime":1714314763000},{"path":"C:\\Users\\Administrator\\Downloads\\myprojectt-master\\vueDataV-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Downloads\\myprojectt-master\\vueDataV-master\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\Administrator\\Downloads\\myprojectt-master\\vueDataV-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Downloads\\myprojectt-master\\vueDataV-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZXhwb3J0IGRlZmF1bHQgewogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBza3U6ICcnLAogICAgICBzdG9ja1R5cGU6ICdub3JtYWwnLAogICAgICBvcmRlclF1YW50aXR5OiAnJywKICAgICAgcXVhbnRpdHk6IFtdLAogICAgICBzaXplczogW10sCiAgICAgIC8vIOWtmOWCqOWwuueggeeahOaVsOe7hAogICAgICByZWNlaXZlZE1lc3NhZ2VzOiAnJywKICAgICAgcmVjZWl2ZWRNZXNzYWdlc3M6IFtdCiAgICB9OwogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuY29ubmVjdFdlYlNvY2tldCgpOwogIH0sCiAgbWV0aG9kczogewogICAgY29ubmVjdFdlYlNvY2tldCgpIHsKICAgICAgLy8gUmVwbGFjZSAnd3M6Ly9sb2NhbGhvc3Q6ODAwMC93cy8nIHdpdGggeW91ciBXZWJTb2NrZXQgc2VydmVyIFVSTAogICAgICB0aGlzLnNvY2tldCA9IG5ldyBXZWJTb2NrZXQoJ3dzOi8vbG9jYWxob3N0OjgwMDAvb3JkZXIvY2hhdC8nKTsKICAgICAgdGhpcy5zb2NrZXQub25tZXNzYWdlID0gZXZlbnQgPT4gewogICAgICAgIHRoaXMucmVjZWl2ZWRNZXNzYWdlc3MgKz0gZXZlbnQuZGF0YSArICdcbic7CiAgICAgIH07CiAgICAgIHRoaXMuc29ja2V0Lm9uY2xvc2UgPSAoKSA9PiB7CiAgICAgICAgY29uc29sZS5sb2coJ1dlYlNvY2tldCBjbG9zZWQuIFJlY29ubmVjdGluZy4uLicpOwogICAgICAgIHRoaXMuY29ubmVjdFdlYlNvY2tldCgpOwogICAgICB9OwogICAgfSwKICAgIGFzeW5jIG9yZGVyYnV0dG9uKCkgewogICAgICB0aGlzLnJlY2VpdmVkTWVzc2FnZXMgPSAnJzsKICAgICAgdGhpcy5yZWNlaXZlZE1lc3NhZ2VzcyA9ICcnOwogICAgICBjb25zdCBkYXRhdG9zZW5kID0gdGhpcy5zaXplcy5tYXAoKHNpemUsIGluZGV4KSA9PiAoewogICAgICAgIHNpemU6IHNpemUsCiAgICAgICAgcXVhbnRpdHk6IHRoaXMucXVhbnRpdHlbaW5kZXhdCiAgICAgIH0pKTsKCiAgICAgIC8vIOiwg+eUqOWQjuerr0FQSeiOt+WPluWwuueggeS/oeaBrwogICAgICBjb25zdCB0aW1lcyA9IHBhcnNlSW50KHRoaXMub3JkZXJRdWFudGl0eSk7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGltZXM7IGkrKykgewogICAgICAgIHRyeSB7CiAgICAgICAgICBsZXQgc3RvY2tUeXBlRW51bVZhbHVlID0gJyc7CiAgICAgICAgICBsZXQgY29tYmluZWREYXRhID0gW107CiAgICAgICAgICBpZiAodGhpcy5zdG9ja1R5cGUgPT09ICdub3JtYWwnKSB7CiAgICAgICAgICAgIHN0b2NrVHlwZUVudW1WYWx1ZSA9ICdOT1JNQUwnOwogICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnN0b2NrVHlwZSA9PT0gJ2ppdCcpIHsKICAgICAgICAgICAgc3RvY2tUeXBlRW51bVZhbHVlID0gJ0pJVCc7CiAgICAgICAgICB9CiAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuJEFQSS5vcmRlci5vcmRlcih7CiAgICAgICAgICAgICdvcmRlclF1YW50aXR5JzogdGhpcy5vcmRlclF1YW50aXR5LAogICAgICAgICAgICAnc3RvY2tUeXBlJzogc3RvY2tUeXBlRW51bVZhbHVlLAogICAgICAgICAgICAnc2tjJzogdGhpcy5za3UsCiAgICAgICAgICAgICdza3VsaXN0JzogZGF0YXRvc2VuZAogICAgICAgICAgfSk7CiAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZS5pbmZvKTsKICAgICAgICAgIGlmIChyZXNwb25zZS5jb2RlID09PSAyMDAwMCkgewogICAgICAgICAgICB0aGlzLnJlY2VpdmVkTWVzc2FnZXMgKz0gJ+esrCcgKyAoaSArIDEpICsgJ+S4quiuouWNleS4uu+8micgKyBKU09OLnN0cmluZ2lmeShyZXNwb25zZS5pbmZvKSArICdcblxuJzsKICAgICAgICAgICAgY29tYmluZWREYXRhID0gcmVzcG9uc2UuaW5mb1swXVsnZG1zaWQnXTsKICAgICAgICAgICAgdGhpcy5zb2NrZXQuc2VuZChjb21iaW5lZERhdGEpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3I6JywgJ3Nkc2YnKTsKICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3InLCBlcnJvcik7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgYXN5bmMgZmV0Y2hTaXplKCkgewogICAgICBpZiAodGhpcy5za3UudHJpbSgpID09PSAnJykgcmV0dXJuOyAvLyDlpoLmnpxTS1XovpPlhaXkuLrnqbrvvIzliJnkuI3osIPnlKjlkI7nq69BUEkKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuJEFQSS5vcmRlci5zaXplKHsKICAgICAgICAgICdza2MnOiB0aGlzLnNrdQogICAgICAgIH0pOwogICAgICAgIGlmIChyZXNwb25zZS5jb2RlID09PSAyMDAwMCkgewogICAgICAgICAgdGhpcy5zaXplcyA9IHJlc3BvbnNlLmluZm87CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yJywgJ3NodWp1Y3Vvd3UnKTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3InLCBlcnJvcik7CiAgICAgIH0KICAgIH0KICB9Cn07"},{"version":3,"names":["data","sku","stockType","orderQuantity","quantity","sizes","receivedMessages","receivedMessagess","mounted","connectWebSocket","methods","socket","WebSocket","onmessage","event","onclose","console","log","orderbutton","datatosend","map","size","index","times","parseInt","i","stockTypeEnumValue","combinedData","response","$API","order","info","code","JSON","stringify","send","error","fetchSize","trim"],"sources":["src/views/Dmsorder.vue"],"sourcesContent":["<template>\n    <div>\n      <div class=\"container\">\n        <div class=\"son-container\">\n          <div class=\"input-group\">\n            <label for=\"sku\" class=\"skuu\">商品id：</label>\n            <input type=\"text\" id=\"sku\" v-model=\"sku\" @keyup.enter=\"fetchSize\" class=\"input-field\">\n          </div>\n          <div class=\"input-group\">\n            <label for=\"stock-type\">商品类型：</label>\n            <select id=\"stock-type\" v-model=\"stockType\" class=\"select-field\">\n              <option value=\"normal\">普通商品</option>\n              <option value=\"jit\">贵重商品</option>\n            </select>\n          </div>\n          <div class=\"input-group\">\n            <label for=\"order-quantity\">订单数量：</label>\n            <input type=\"number\" id=\"order-quantity\" v-model=\"orderQuantity\" class=\"select-field\">\n          </div>\n          <div class=\"input-group\">\n            <label class=\"size-label\">商品条码：</label>\n            <div v-for=\"(size, index) in sizes\" :key=\"index\">\n              <input type=\"text\" v-model=\"quantity[index]\" :placeholder=\"sizes[index]['sku']\" class=\"size-input\">\n            </div>\n          </div>\n          <div>\n            <button @click=\"orderbutton\" class=\"order-button\">一键下单</button>\n          </div>\n        </div>\n        <div class=\"log\">\n          <h3 class=\"logview\" align=\"center\">下单跟进日志</h3>\n          <textarea v-model=\"receivedMessagess\" rows=\"10\" cols=\"50\" readonly class=\"message-box\"></textarea>\n          <h3 class=\"logview\" align=\"center\">返回参数</h3>\n          <textarea v-model=\"receivedMessages\" rows=\"10\" cols=\"50\" readonly class=\"message-box\"></textarea>\n        </div>\n      </div>\n    </div>\n  \n  </template>\n  \n  <script>\n  export default {\n    data() {\n      return {\n        sku: '',\n        stockType: 'normal',\n        orderQuantity: '',\n        quantity: [],\n        sizes: [], // 存储尺码的数组\n        receivedMessages: '',\n        receivedMessagess: []\n      };\n    },\n  \n    mounted() {\n      this.connectWebSocket()\n    },\n  \n    methods: {\n  \n      connectWebSocket() {\n        // Replace 'ws://localhost:8000/ws/' with your WebSocket server URL\n        this.socket = new WebSocket('ws://localhost:8000/order/chat/');\n  \n        this.socket.onmessage = event => {\n          this.receivedMessagess += event.data + '\\n';\n        };\n        this.socket.onclose = () => {\n          console.log('WebSocket closed. Reconnecting...');\n          this.connectWebSocket();\n        };\n      },\n  \n      async orderbutton() {\n        this.receivedMessages = '';\n        this.receivedMessagess='';\n        const datatosend = this.sizes.map((size, index) => ({\n          size: size,\n          quantity: this.quantity[index]\n        }));\n  \n        // 调用后端API获取尺码信息\n        const times = parseInt(this.orderQuantity);\n        for (let i = 0; i < times; i++) {\n          try {\n            let stockTypeEnumValue = '';\n            let combinedData = [];\n            if (this.stockType === 'normal') {\n              stockTypeEnumValue = 'NORMAL';\n            } else if (this.stockType === 'jit') {\n              stockTypeEnumValue = 'JIT';\n            }\n            const response = await this.$API.order.order({\n              'orderQuantity': this.orderQuantity,\n              'stockType': stockTypeEnumValue,\n              'skc': this.sku,\n              'skulist': datatosend\n            });\n            console.log(response.info)\n            if (response.code === 20000) {\n              this.receivedMessages += ('第' + (i + 1) + '个订单为：' + JSON.stringify(response.info)) + '\\n\\n'\n              combinedData=response.info[0]['dmsid'];\n              this.socket.send(combinedData)\n            } else {\n              console.error('Error:', 'sdsf');\n            }\n          } catch (error) {\n            console.error('Error', error);\n          }\n        }\n  \n  \n      },\n  \n      async fetchSize() {\n        if (this.sku.trim() === '') return; // 如果SKU输入为空，则不调用后端API\n        try {\n          const response = await this.$API.order.size({'skc': this.sku});\n          if (response.code === 20000) {\n            this.sizes = response.info;\n          } else {\n            console.error('Error', 'shujucuowu');\n          }\n        } catch (error) {\n          console.error('Error', error);\n        }\n      }\n    }\n  };\n  </script>\n  \n  <style scoped>\n  .container {\n    display: flex;\n    flex-direction: row;\n    margin-left: 3%;\n  }\n  \n  .input-group {\n    margin-bottom: 20px;\n  }\n  \n  .input-field {\n    padding: 8px;\n    border: 1px solid #ccc;\n    border-radius: 5px;\n    width: 100%;\n    margin-left: 30px;\n  }\n  \n  .skuu {\n    margin-left: 30px;\n  }\n  \n  .size-label {\n    margin-left: 30px;\n  }\n  \n  .select-field {\n    padding: 8px;\n    border: 1px solid #ccc;\n    border-radius: 5px;\n    width: 100%;\n    box-sizing: border-box;\n    margin-top: 5px;\n    margin-left: 30px;\n  \n  }\n  \n  .size-input {\n    padding: 8px;\n    border: 1px solid #ccc;\n    border-radius: 5px;\n    width: 100%;\n    box-sizing: border-box;\n    margin-top: 5px;\n    margin-left: 30px;\n  }\n  \n  .log {\n    margin-left: 30%;\n    margin-top: 0px;\n  }\n  \n  .order-button {\n    padding: 10px 20px;\n    border: none;\n    border-radius: 10px;\n    background-color: #007bff;\n    color: white;\n    cursor: pointer;\n    margin-left: 155px;\n  }\n  \n  .size-input {\n    width: calc(100% - 5px); /* 尺码输入框宽度根据列数自动调整 */\n    margin-right: 5px;\n  }\n  \n  .message-box {\n    border: 1px solid #ccc;\n    border-radius: 10px;\n    padding: 10px;\n    width: 600px;\n    height: 300px;\n    margin-bottom: 10px;\n  }\n  </style>\n  "],"mappings":"AAyCA;EACAA,KAAA;IACA;MACAC,GAAA;MACAC,SAAA;MACAC,aAAA;MACAC,QAAA;MACAC,KAAA;MAAA;MACAC,gBAAA;MACAC,iBAAA;IACA;EACA;EAEAC,QAAA;IACA,KAAAC,gBAAA;EACA;EAEAC,OAAA;IAEAD,iBAAA;MACA;MACA,KAAAE,MAAA,OAAAC,SAAA;MAEA,KAAAD,MAAA,CAAAE,SAAA,GAAAC,KAAA;QACA,KAAAP,iBAAA,IAAAO,KAAA,CAAAd,IAAA;MACA;MACA,KAAAW,MAAA,CAAAI,OAAA;QACAC,OAAA,CAAAC,GAAA;QACA,KAAAR,gBAAA;MACA;IACA;IAEA,MAAAS,YAAA;MACA,KAAAZ,gBAAA;MACA,KAAAC,iBAAA;MACA,MAAAY,UAAA,QAAAd,KAAA,CAAAe,GAAA,EAAAC,IAAA,EAAAC,KAAA;QACAD,IAAA,EAAAA,IAAA;QACAjB,QAAA,OAAAA,QAAA,CAAAkB,KAAA;MACA;;MAEA;MACA,MAAAC,KAAA,GAAAC,QAAA,MAAArB,aAAA;MACA,SAAAsB,CAAA,MAAAA,CAAA,GAAAF,KAAA,EAAAE,CAAA;QACA;UACA,IAAAC,kBAAA;UACA,IAAAC,YAAA;UACA,SAAAzB,SAAA;YACAwB,kBAAA;UACA,gBAAAxB,SAAA;YACAwB,kBAAA;UACA;UACA,MAAAE,QAAA,cAAAC,IAAA,CAAAC,KAAA,CAAAA,KAAA;YACA,sBAAA3B,aAAA;YACA,aAAAuB,kBAAA;YACA,YAAAzB,GAAA;YACA,WAAAkB;UACA;UACAH,OAAA,CAAAC,GAAA,CAAAW,QAAA,CAAAG,IAAA;UACA,IAAAH,QAAA,CAAAI,IAAA;YACA,KAAA1B,gBAAA,WAAAmB,CAAA,kBAAAQ,IAAA,CAAAC,SAAA,CAAAN,QAAA,CAAAG,IAAA;YACAJ,YAAA,GAAAC,QAAA,CAAAG,IAAA;YACA,KAAApB,MAAA,CAAAwB,IAAA,CAAAR,YAAA;UACA;YACAX,OAAA,CAAAoB,KAAA;UACA;QACA,SAAAA,KAAA;UACApB,OAAA,CAAAoB,KAAA,UAAAA,KAAA;QACA;MACA;IAGA;IAEA,MAAAC,UAAA;MACA,SAAApC,GAAA,CAAAqC,IAAA;MACA;QACA,MAAAV,QAAA,cAAAC,IAAA,CAAAC,KAAA,CAAAT,IAAA;UAAA,YAAApB;QAAA;QACA,IAAA2B,QAAA,CAAAI,IAAA;UACA,KAAA3B,KAAA,GAAAuB,QAAA,CAAAG,IAAA;QACA;UACAf,OAAA,CAAAoB,KAAA;QACA;MACA,SAAAA,KAAA;QACApB,OAAA,CAAAoB,KAAA,UAAAA,KAAA;MACA;IACA;EACA;AACA","ignoreList":[]}]}