{"remainingRequest":"C:\\Users\\Administrator\\Downloads\\myprojectt-master\\vueDataV-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Downloads\\myprojectt-master\\vueDataV-master\\src\\views\\Dmsorder.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\Administrator\\Downloads\\myprojectt-master\\vueDataV-master\\src\\views\\Dmsorder.vue","mtime":1714314763000},{"path":"C:\\Users\\Administrator\\Downloads\\myprojectt-master\\vueDataV-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Downloads\\myprojectt-master\\vueDataV-master\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\Administrator\\Downloads\\myprojectt-master\\vueDataV-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Downloads\\myprojectt-master\\vueDataV-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiAgZXhwb3J0IGRlZmF1bHQgewogICAgZGF0YSgpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBza3U6ICcnLAogICAgICAgIHN0b2NrVHlwZTogJ25vcm1hbCcsCiAgICAgICAgb3JkZXJRdWFudGl0eTogJycsCiAgICAgICAgcXVhbnRpdHk6IFtdLAogICAgICAgIHNpemVzOiBbXSwgLy8g5a2Y5YKo5bC656CB55qE5pWw57uECiAgICAgICAgcmVjZWl2ZWRNZXNzYWdlczogJycsCiAgICAgICAgcmVjZWl2ZWRNZXNzYWdlc3M6IFtdCiAgICAgIH07CiAgICB9LAogIAogICAgbW91bnRlZCgpIHsKICAgICAgdGhpcy5jb25uZWN0V2ViU29ja2V0KCkKICAgIH0sCiAgCiAgICBtZXRob2RzOiB7CiAgCiAgICAgIGNvbm5lY3RXZWJTb2NrZXQoKSB7CiAgICAgICAgLy8gUmVwbGFjZSAnd3M6Ly9sb2NhbGhvc3Q6ODAwMC93cy8nIHdpdGggeW91ciBXZWJTb2NrZXQgc2VydmVyIFVSTAogICAgICAgIHRoaXMuc29ja2V0ID0gbmV3IFdlYlNvY2tldCgnd3M6Ly9sb2NhbGhvc3Q6ODAwMC9vcmRlci9jaGF0LycpOwogIAogICAgICAgIHRoaXMuc29ja2V0Lm9ubWVzc2FnZSA9IGV2ZW50ID0+IHsKICAgICAgICAgIHRoaXMucmVjZWl2ZWRNZXNzYWdlc3MgKz0gZXZlbnQuZGF0YSArICdcbic7CiAgICAgICAgfTsKICAgICAgICB0aGlzLnNvY2tldC5vbmNsb3NlID0gKCkgPT4gewogICAgICAgICAgY29uc29sZS5sb2coJ1dlYlNvY2tldCBjbG9zZWQuIFJlY29ubmVjdGluZy4uLicpOwogICAgICAgICAgdGhpcy5jb25uZWN0V2ViU29ja2V0KCk7CiAgICAgICAgfTsKICAgICAgfSwKICAKICAgICAgYXN5bmMgb3JkZXJidXR0b24oKSB7CiAgICAgICAgdGhpcy5yZWNlaXZlZE1lc3NhZ2VzID0gJyc7CiAgICAgICAgdGhpcy5yZWNlaXZlZE1lc3NhZ2Vzcz0nJzsKICAgICAgICBjb25zdCBkYXRhdG9zZW5kID0gdGhpcy5zaXplcy5tYXAoKHNpemUsIGluZGV4KSA9PiAoewogICAgICAgICAgc2l6ZTogc2l6ZSwKICAgICAgICAgIHF1YW50aXR5OiB0aGlzLnF1YW50aXR5W2luZGV4XQogICAgICAgIH0pKTsKICAKICAgICAgICAvLyDosIPnlKjlkI7nq69BUEnojrflj5blsLrnoIHkv6Hmga8KICAgICAgICBjb25zdCB0aW1lcyA9IHBhcnNlSW50KHRoaXMub3JkZXJRdWFudGl0eSk7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aW1lczsgaSsrKSB7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBsZXQgc3RvY2tUeXBlRW51bVZhbHVlID0gJyc7CiAgICAgICAgICAgIGxldCBjb21iaW5lZERhdGEgPSBbXTsKICAgICAgICAgICAgaWYgKHRoaXMuc3RvY2tUeXBlID09PSAnbm9ybWFsJykgewogICAgICAgICAgICAgIHN0b2NrVHlwZUVudW1WYWx1ZSA9ICdOT1JNQUwnOwogICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc3RvY2tUeXBlID09PSAnaml0JykgewogICAgICAgICAgICAgIHN0b2NrVHlwZUVudW1WYWx1ZSA9ICdKSVQnOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy4kQVBJLm9yZGVyLm9yZGVyKHsKICAgICAgICAgICAgICAnb3JkZXJRdWFudGl0eSc6IHRoaXMub3JkZXJRdWFudGl0eSwKICAgICAgICAgICAgICAnc3RvY2tUeXBlJzogc3RvY2tUeXBlRW51bVZhbHVlLAogICAgICAgICAgICAgICdza2MnOiB0aGlzLnNrdSwKICAgICAgICAgICAgICAnc2t1bGlzdCc6IGRhdGF0b3NlbmQKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlLmluZm8pCiAgICAgICAgICAgIGlmIChyZXNwb25zZS5jb2RlID09PSAyMDAwMCkgewogICAgICAgICAgICAgIHRoaXMucmVjZWl2ZWRNZXNzYWdlcyArPSAoJ+esrCcgKyAoaSArIDEpICsgJ+S4quiuouWNleS4uu+8micgKyBKU09OLnN0cmluZ2lmeShyZXNwb25zZS5pbmZvKSkgKyAnXG5cbicKICAgICAgICAgICAgICBjb21iaW5lZERhdGE9cmVzcG9uc2UuaW5mb1swXVsnZG1zaWQnXTsKICAgICAgICAgICAgICB0aGlzLnNvY2tldC5zZW5kKGNvbWJpbmVkRGF0YSkKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvcjonLCAnc2RzZicpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvcicsIGVycm9yKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgCiAgCiAgICAgIH0sCiAgCiAgICAgIGFzeW5jIGZldGNoU2l6ZSgpIHsKICAgICAgICBpZiAodGhpcy5za3UudHJpbSgpID09PSAnJykgcmV0dXJuOyAvLyDlpoLmnpxTS1XovpPlhaXkuLrnqbrvvIzliJnkuI3osIPnlKjlkI7nq69BUEkKICAgICAgICB0cnkgewogICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLiRBUEkub3JkZXIuc2l6ZSh7J3NrYyc6IHRoaXMuc2t1fSk7CiAgICAgICAgICBpZiAocmVzcG9uc2UuY29kZSA9PT0gMjAwMDApIHsKICAgICAgICAgICAgdGhpcy5zaXplcyA9IHJlc3BvbnNlLmluZm87CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvcicsICdzaHVqdWN1b3d1Jyk7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yJywgZXJyb3IpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH07CiAg"},{"version":3,"sources":["Dmsorder.vue"],"names":[],"mappings":";AAyCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Dmsorder.vue","sourceRoot":"src/views","sourcesContent":["<template>\n    <div>\n      <div class=\"container\">\n        <div class=\"son-container\">\n          <div class=\"input-group\">\n            <label for=\"sku\" class=\"skuu\">商品id：</label>\n            <input type=\"text\" id=\"sku\" v-model=\"sku\" @keyup.enter=\"fetchSize\" class=\"input-field\">\n          </div>\n          <div class=\"input-group\">\n            <label for=\"stock-type\">商品类型：</label>\n            <select id=\"stock-type\" v-model=\"stockType\" class=\"select-field\">\n              <option value=\"normal\">普通商品</option>\n              <option value=\"jit\">贵重商品</option>\n            </select>\n          </div>\n          <div class=\"input-group\">\n            <label for=\"order-quantity\">订单数量：</label>\n            <input type=\"number\" id=\"order-quantity\" v-model=\"orderQuantity\" class=\"select-field\">\n          </div>\n          <div class=\"input-group\">\n            <label class=\"size-label\">商品条码：</label>\n            <div v-for=\"(size, index) in sizes\" :key=\"index\">\n              <input type=\"text\" v-model=\"quantity[index]\" :placeholder=\"sizes[index]['sku']\" class=\"size-input\">\n            </div>\n          </div>\n          <div>\n            <button @click=\"orderbutton\" class=\"order-button\">一键下单</button>\n          </div>\n        </div>\n        <div class=\"log\">\n          <h3 class=\"logview\" align=\"center\">下单跟进日志</h3>\n          <textarea v-model=\"receivedMessagess\" rows=\"10\" cols=\"50\" readonly class=\"message-box\"></textarea>\n          <h3 class=\"logview\" align=\"center\">返回参数</h3>\n          <textarea v-model=\"receivedMessages\" rows=\"10\" cols=\"50\" readonly class=\"message-box\"></textarea>\n        </div>\n      </div>\n    </div>\n  \n  </template>\n  \n  <script>\n  export default {\n    data() {\n      return {\n        sku: '',\n        stockType: 'normal',\n        orderQuantity: '',\n        quantity: [],\n        sizes: [], // 存储尺码的数组\n        receivedMessages: '',\n        receivedMessagess: []\n      };\n    },\n  \n    mounted() {\n      this.connectWebSocket()\n    },\n  \n    methods: {\n  \n      connectWebSocket() {\n        // Replace 'ws://localhost:8000/ws/' with your WebSocket server URL\n        this.socket = new WebSocket('ws://localhost:8000/order/chat/');\n  \n        this.socket.onmessage = event => {\n          this.receivedMessagess += event.data + '\\n';\n        };\n        this.socket.onclose = () => {\n          console.log('WebSocket closed. Reconnecting...');\n          this.connectWebSocket();\n        };\n      },\n  \n      async orderbutton() {\n        this.receivedMessages = '';\n        this.receivedMessagess='';\n        const datatosend = this.sizes.map((size, index) => ({\n          size: size,\n          quantity: this.quantity[index]\n        }));\n  \n        // 调用后端API获取尺码信息\n        const times = parseInt(this.orderQuantity);\n        for (let i = 0; i < times; i++) {\n          try {\n            let stockTypeEnumValue = '';\n            let combinedData = [];\n            if (this.stockType === 'normal') {\n              stockTypeEnumValue = 'NORMAL';\n            } else if (this.stockType === 'jit') {\n              stockTypeEnumValue = 'JIT';\n            }\n            const response = await this.$API.order.order({\n              'orderQuantity': this.orderQuantity,\n              'stockType': stockTypeEnumValue,\n              'skc': this.sku,\n              'skulist': datatosend\n            });\n            console.log(response.info)\n            if (response.code === 20000) {\n              this.receivedMessages += ('第' + (i + 1) + '个订单为：' + JSON.stringify(response.info)) + '\\n\\n'\n              combinedData=response.info[0]['dmsid'];\n              this.socket.send(combinedData)\n            } else {\n              console.error('Error:', 'sdsf');\n            }\n          } catch (error) {\n            console.error('Error', error);\n          }\n        }\n  \n  \n      },\n  \n      async fetchSize() {\n        if (this.sku.trim() === '') return; // 如果SKU输入为空，则不调用后端API\n        try {\n          const response = await this.$API.order.size({'skc': this.sku});\n          if (response.code === 20000) {\n            this.sizes = response.info;\n          } else {\n            console.error('Error', 'shujucuowu');\n          }\n        } catch (error) {\n          console.error('Error', error);\n        }\n      }\n    }\n  };\n  </script>\n  \n  <style scoped>\n  .container {\n    display: flex;\n    flex-direction: row;\n    margin-left: 3%;\n  }\n  \n  .input-group {\n    margin-bottom: 20px;\n  }\n  \n  .input-field {\n    padding: 8px;\n    border: 1px solid #ccc;\n    border-radius: 5px;\n    width: 100%;\n    margin-left: 30px;\n  }\n  \n  .skuu {\n    margin-left: 30px;\n  }\n  \n  .size-label {\n    margin-left: 30px;\n  }\n  \n  .select-field {\n    padding: 8px;\n    border: 1px solid #ccc;\n    border-radius: 5px;\n    width: 100%;\n    box-sizing: border-box;\n    margin-top: 5px;\n    margin-left: 30px;\n  \n  }\n  \n  .size-input {\n    padding: 8px;\n    border: 1px solid #ccc;\n    border-radius: 5px;\n    width: 100%;\n    box-sizing: border-box;\n    margin-top: 5px;\n    margin-left: 30px;\n  }\n  \n  .log {\n    margin-left: 30%;\n    margin-top: 0px;\n  }\n  \n  .order-button {\n    padding: 10px 20px;\n    border: none;\n    border-radius: 10px;\n    background-color: #007bff;\n    color: white;\n    cursor: pointer;\n    margin-left: 155px;\n  }\n  \n  .size-input {\n    width: calc(100% - 5px); /* 尺码输入框宽度根据列数自动调整 */\n    margin-right: 5px;\n  }\n  \n  .message-box {\n    border: 1px solid #ccc;\n    border-radius: 10px;\n    padding: 10px;\n    width: 600px;\n    height: 300px;\n    margin-bottom: 10px;\n  }\n  </style>\n  "]}]}